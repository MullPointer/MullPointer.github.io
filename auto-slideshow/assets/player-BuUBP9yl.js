import{S as m,p as g}from"./utility-BmZmnbek.js";const a=5e3,u=1e3,c=new URLSearchParams(window.location.search),n=new Array;let o=null,e=-1;if(c.has("data")){const t=c.get("data");console.log("loading slideshow ",t);const s=new m;s.deserialize(t),s.mapSlides(d=>n.push(d)),s.name&&(document.getElementById("slideshow-name").textContent=s.name)}for(const t of n)g(t.imgURL);function h(){document.getElementById("intro").classList.add("hidden"),document.getElementById("about").classList.add("hidden"),document.getElementById("player").classList.remove("hidden")}function y(){document.getElementById("player").classList.add("hidden"),document.getElementById("intro").classList.remove("hidden"),document.getElementById("about").classList.remove("hidden")}async function f(t){return new Promise((s,d)=>{const l=window.speechSynthesis;(o||l.speaking||l.pending)&&(console.warn("New speech synthesis started before previous complete"),l.cancel(),o=null),console.log("speaking: ",t),o=new SpeechSynthesisUtterance(t),o.rate=.7,o.onerror=r=>{console.error("error in speech synthesis: ",r.error),o=null,d()},o.onend=()=>{o=null,s()},l.speak(o)})}function p(t){const s=document.getElementById("displayImg");!t||t===""?s.classList.add("invisible"):(s.classList.remove("invisible"),s.src=t)}async function i(){n.length<=0||(e++,e==0?(h(),console.log("slideshow begins on slide ",e,n[e])):e>=n.length?(e=-1,y(),console.log("slideshow ends")):console.log("slide advances to ",e,n[e]),e>=0&&(p(n[e].imgURL),n[e].text.trim()===""?n[e].imgURL===""?setTimeout(i):setTimeout(i,a):await f(n[e].text).then(()=>setTimeout(i,u),()=>setTimeout(i,a))))}document.getElementById("ctrl-start-slideshow").addEventListener("click",async()=>{i()});document.getElementById("ctrl-about").addEventListener("click",()=>{document.getElementById("about-details").classList.toggle("hidden")});
