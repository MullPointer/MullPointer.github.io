import{S as m,p as u}from"./utility-gbfQFRsr.js";const a=5e3,g=1e3,c=new URLSearchParams(window.location.search),s=new Array;let o=null,n=-1;if(c.has("data")){const t=c.get("data");console.log("loading slideshow ",t);const e=new m;e.deserialize(t),e.mapSlides(d=>s.push(d)),e.name&&(document.getElementById("slideshow-name").textContent=e.name)}for(const t of s)u(t.imgURL);function h(){document.getElementById("intro").classList.add("hidden"),document.getElementById("about").classList.add("hidden"),document.getElementById("player").classList.remove("hidden")}function f(){document.getElementById("player").classList.add("hidden"),document.getElementById("intro").classList.remove("hidden"),document.getElementById("about").classList.remove("hidden"),document.getElementById("ctrl-start-slideshow").focus()}async function y(t){return new Promise((e,d)=>{const i=window.speechSynthesis;(o||i.speaking||i.pending)&&(console.warn("New speech synthesis started before previous complete"),i.cancel(),o=null),console.log("speaking: ",t),o=new SpeechSynthesisUtterance(t),o.rate=.7,o.onerror=r=>{console.error("error in speech synthesis: ",r.error),o=null,d()},o.onend=()=>{o=null,e()},i.speak(o)})}function p(t){const e=document.getElementById("displayImg");!t||t===""?e.classList.add("invisible"):(e.classList.remove("invisible"),e.src=t)}async function l(){s.length<=0||(n++,n==0?(h(),console.log("slideshow begins on slide ",n,s[n])):n>=s.length?(n=-1,f(),console.log("slideshow ends")):console.log("slide advances to ",n,s[n]),n>=0&&(p(s[n].imgURL),s[n].text.trim()===""?s[n].imgURL===""?setTimeout(l):setTimeout(l,a):await y(s[n].text).then(()=>setTimeout(l,g),()=>setTimeout(l,a))))}document.getElementById("ctrl-start-slideshow").addEventListener("click",async()=>{l()});document.getElementById("ctrl-about").addEventListener("click",t=>{const e=t.currentTarget,d=e.getAttribute("aria-controls");if(d){const i=document.getElementById(d);e.ariaExpanded==="true"?(e.ariaExpanded="false",i.ariaHidden="true"):(e.ariaExpanded="true",i.ariaHidden="false")}});
