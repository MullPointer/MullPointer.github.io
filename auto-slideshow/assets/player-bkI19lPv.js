import{S as m,p as g}from"./utility-4YXPZxWt.js";const d=5e3,h=500,c=new URLSearchParams(window.location.search),t=new Array;let i=null,e=-1;if(c.has("data")){const s=c.get("data");console.log("loading slideshow ",s);const n=new m;n.deserialize(s),n.mapSlides(a=>t.push(a)),n.name&&(document.getElementById("slideshow-name").textContent=n.name)}for(const s of t)g(s.imgURL);function u(){document.getElementById("intro").classList.add("hidden"),document.getElementById("player").classList.remove("hidden")}function f(){document.getElementById("player").classList.add("hidden"),document.getElementById("intro").classList.remove("hidden")}async function p(s){return new Promise((n,a)=>{const l=window.speechSynthesis;(i||l.speaking||l.pending)&&(console.warn("New speech synthesis started before previous complete"),l.cancel(),i=null),console.log("speaking: ",s),i=new SpeechSynthesisUtterance(s),i.onerror=r=>{console.error("error in speech synthesis: ",r.error),i=null,a()},i.onend=()=>{i=null,n()},l.speak(i)})}function w(s){const n=document.getElementById("displayImg");!s||s===""?n.classList.add("invisible"):(n.classList.remove("invisible"),n.src=s)}async function o(){t.length<=0||(e++,e==0?(u(),console.log("slideshow begins on slide ",e,t[e])):e>=t.length?(e=-1,f(),console.log("slideshow ends")):console.log("slide advances to ",e,t[e]),e>=0&&(w(t[e].imgURL),t[e].text.trim()===""?t[e].imgURL===""?setTimeout(o):setTimeout(o,d):await p(t[e].text).then(()=>setTimeout(o,h),()=>setTimeout(o,d))))}document.getElementById("ctrl-start-slideshow").addEventListener("click",async()=>{o()});
