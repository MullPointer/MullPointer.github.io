var a=Object.defineProperty;var c=(t,e,o)=>e in t?a(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var s=(t,e,o)=>(c(t,typeof e!="symbol"?e+"":e,o),o);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function o(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=o(r);fetch(r.href,n)}})();function d(t){return t===""||t.match(/^images\/[\w\-\.]+$/)!==null}class u{constructor(e=""){s(this,"dom");this.dom=document.implementation.createDocument(null,"slideshow"),e!==""&&this.deserialize(e)}get name(){return this.dom.documentElement.getAttribute("name")||""}set name(e){const o=this.dom.documentElement,i=document.createAttributeNS(null,"name");i.value=e,o.attributes.setNamedItemNS(i)}validateImgURL(e){if(!d(e)){const o="Unapproved URL used for image "+e;throw console.error(o),URIError(o)}}appendSlide(e){const o=this.dom.documentElement,i=document.createElementNS(null,"slide"),r=document.createAttributeNS(null,"image");this.validateImgURL(e.imgURL),r.value=e.imgURL,i.attributes.setNamedItemNS(r);const n=document.createTextNode(e.text);i.appendChild(n),o.appendChild(i)}mapSlides(e){const o=this.dom.documentElement.children;for(const i of o){const r=i.textContent,n=i.getAttribute("image")||"";this.validateImgURL(n),e({text:r||"",imgURL:n||""})}}serialize(){return new XMLSerializer().serializeToString(this.dom)}deserialize(e){let i=new DOMParser().parseFromString(e,"application/xml");const r=i.querySelector("parsererror");if(r){const n=r.innerHTML;throw new SyntaxError(n)}else{if(i.documentElement.tagName!=="slideshow")throw new SyntaxError("Not a slideshow XML file");this.dom=i}}}function p(t,e){return t=t.replace(/\<\>\:\"\/\\\|\?\*/g,""),t=t.replace(/[\x00-\x1F]/g,""),t=t.replace(/[\W\.]+$/g,""),t=t.replace(/(^CON$)|(^PRN$)|(^AUX$)|(^NUL$)|(^COM[1-9]$)|(^LPT[1-9]$)/i,""),t=t.replace(/ /g,"-"),t=t.toLocaleLowerCase(),t===""?e:t}async function f(){return new Promise((t,e)=>{let o=document.createElement("input");o.type="file",o.multiple=!1,o.accept=".xml,application/xml",o.onchange=()=>{let i=o.files[0];console.log("file selected to load ",i),i?t(i):e("No file selected")},o.click()}).then(t=>t.text())}function g(t,e){let o=document.createElement("a");o.href=t,o.download=e,o.click()}function h(t){let e=new Image;e.src=t}export{u as S,g as d,d as i,p as m,h as p,f as u};
